%
%% IC Engine Technical Specifications
% Jeff Naber
% Michigan Tech
% Date: 2011-03-20
%
% Initialization File For MTU_HVM_3_1a.mdl / HW3
%
% ICE_Option is selected in "Student_Design_Parameters.m"
%

% -------------------------------------------------------------------------
%
% 3.0b  JND     Fixed Problem with Engine option 4 in release 3_0a
%               Added variable "Engine_Displacement_L" for scaling
% 3.0d  JDN     Added Engine option 5
% 3.1a  JDN     Improved engine option 5 and scaled to Malibu 2010 2.4L
%               Extended T, BSFC to 6800 for shift discussion
%               Set ACC loss to 4.6 N-m
%
%
% -------------------------------------------------------------------------

%%
s = sprintf ('   - Setting ICE Option Parameters:  ICE_Option = %2d', ICE_Option);
disp(s);


%% Engine Options
% Baseline 3.6L V6 w/ Fixed Cam Timing
if (ICE_Option == 0) 
    Engine_Displacement_L   =    3.6;                             % Liters
    Engine_ACC_Loss_Nm      =   17.1*Engine_Displacement_L/3.6;   % Accessory loss, N-m - Scaled down by displacement from Baseline
    Engine_Startup_Fuel_g   =    4.0*Engine_Displacement_L/3.6;   % Fuel, grams	Scaled down by displacement from Baseline

    Engine_Min_Speed_rpm    =  800;    % Max engine speed, rpm
    Engine_Max_Speed_rpm    = 6000;    % Max engine speed, rpm

    % Index maps for BSFC and Torque
    Engine_2DMAP_Index_TR   = [0.08, 0.16, 0.24, 0.32, 0.40, 0.48, 0.56, 0.64, 0.72, 0.80, 0.88, 0.96, 1.00];
    Engine_2DMAP_Index_RPM  = [800,  1200, 1600, 2000, 2400, 2800, 3200, 3600, 4000, 4800, 6000];

    Engine_Torque_2DMAP_Nm =[      17    14    10     7    31    27    26    26    17     9     3;
                                   46    41    36    34    60    57    55    77    45    36    22;
                                   72    67    65    63    87    84    82   106    74    63    50;
                                   98    94    93    91   115   113   111   134   101    91    77;
                                  122   122   120   118   142   141   139   161   127   118   103;
                                  147   147   146   146   170   168   166   189   154   146   130;
                                  171   175   173   173   180   195   194   214   182   171   156;
                                  195   201   201   201   197   223   221   231   209   199   182;
                                  219   226   228   228   225   250   249   254   237   225   206;
                                  243   252   254   255   252   279   276   274   264   252   231;
                                  266   278   281   283   279   305   303   297   290   278   257;
                                  273   303   307   309   307   333   329   322   317   305   283;
                                  273   310   331   333   334   353   350   350   345   331   305;];
    Engine_Torque_2DMAP_Nm = Engine_Torque_2DMAP_Nm';

    Engine_BSFC_2DMAP_g_kWh = [ 855         869        1167        1591         549         628         707         991        1240        3058        9624;
                                452         469         486         499         385         413         450         427         644         986        2248;
                                388         379         371         368         329         346         372         378         499         707        1311;
                                358         337         327         319         300         313         334         349         437         596        1029;
                                342         316         302         293         283         293         313         332         402         538         892;
                                331         302         287         278         271         280         299         319         378         503         814;
                                324         294         277         267         267         270         288         310         362         480         765;
                                321         287         270         260         262         264         281         294         349         460         728;
                                316         282         265         254         255         259         275         290         342         447         703;
                                315         279         261         250         251         276         291         306         342         437         684;
                                324         298         281         271         268         297         313         335         370         463         669;
                                331         325         304         294         291         319         338         365         400         498         720;
                                331         332         327         313         314         338         355         396         428         533         765;];
                        
    Engine_BSFC_2DMAP_g_kWh = Engine_BSFC_2DMAP_g_kWh';     

% Engine Option #1 - 2.0L 4-cyl w/ Fixed Cam Timing
elseif(ICE_Option == 1)   
    Engine_Displacement_L   =    2.0;                             % Liters
    Engine_ACC_Loss_Nm      =   17.1*Engine_Displacement_L/3.6;   % Accessory loss, N-m - Scaled down by displacement from Baseline
    Engine_Startup_Fuel_g   =    4.0*Engine_Displacement_L/3.6;   % Fuel, grams	Scaled down by displacement from Baseline

    Engine_Min_Speed_rpm    =  800;           % Max engine speed, rpm
    Engine_Max_Speed_rpm    = 6000;           % Max engine speed, rpm

    % Index maps for BSFC and Torque
    Engine_2DMAP_Index_TR   = [0.08, 0.16, 0.24, 0.32, 0.40, 0.48, 0.56, 0.64, 0.72, 0.80, 0.88, 0.96, 1.00];
    Engine_2DMAP_Index_RPM  = [800,  1200, 1600, 2000, 2400, 2800, 3200, 3600, 4000, 4800, 6000];

    Engine_Torque_2DMAP_Nm =[   12	13	13	13	13	13	14	14	14	14	14;
                                25	25	26	26	26	27	27	28	28	29	28;
                                37	38	38	39	40	40	41	42	42	43	42;
                                50	51	51	52	53	54	55	56	56	58	56;
                                62	63	64	65	66	67	68	70	70	72	70;
                                74	76	77	78	79	81	82	84	84	86	84;
                                87	88	90	91	92	94	96	97	99	101	98;
                                99	101	102	104	106	108	109	111	113	115	112;
                                112	114	115	117	119	121	123	125	127	130	126;
                                124	126	128	130	132	134	137	139	141	144	140;
                                136	139	141	143	145	148	150	153	155	158	154;
                                149	152	154	156	158	161	164	167	169	173	168;
                                155	158	160	163	165	168	171	174	176	180	175];
    Engine_Torque_2DMAP_Nm = Engine_Torque_2DMAP_Nm';

    Engine_BSFC_2DMAP_g_kWh = [ 594.87	666.13	737.40	796.31	842.59	878.02	905.35	927.36	945.81	967.89	1001.0;
                                455.01	506.66	558.32	598.87	628.60	649.81	665.82	679.93	694.45	722.76	765.22;
                                345.50	378.00	410.51	432.95	446.20	453.12	457.62	463.59	473.91	507.98	559.08;
                                291.78	311.90	332.01	342.57	344.85	342.15	338.78	339.05	346.27	383.58	439.55;
                                267.89	281.02	294.15	297.90	293.80	285.40	277.28	274.00	279.11	317.57	375.25;
                                256.35	266.54	276.73	277.60	270.77	259.89	249.62	244.61	248.51	286.44	343.34;
                                246.92	256.86	266.80	267.58	260.74	249.85	239.51	234.29	237.77	273.93	328.17;
                                242.32	246.35	257.38	259.70	254.62	245.48	236.63	232.41	236.15	269.72	320.08;
                                240.94	234.03	246.13	250.49	248.01	241.63	235.31	232.98	237.59	268.17	314.05;
                                250.54	222.33	234.12	239.86	239.88	236.57	233.30	233.45	239.41	267.04	308.47;
                                260.04	215.79	224.55	229.87	231.35	230.66	230.45	233.37	241.06	266.18	303.87;
                                270.16	229.80	231.44	233.39	234.37	225.14	227.47	233.11	242.83	266.33	301.58;
                                270.24	247.36	243.48	242.28	241.98	242.82	246.06	242.96	243.77	266.91	301.64;];
                        
    Engine_BSFC_2DMAP_g_kWh = Engine_BSFC_2DMAP_g_kWh';  

% Engine Option #2 - 2.0L 4-cyl w/ Variable Valve Timing
elseif(ICE_Option == 2)   
    Engine_Displacement_L   =    2.0;                             % Liters
    Engine_ACC_Loss_Nm      =   17.1*Engine_Displacement_L/3.6;   % Accessory loss, N-m - Scaled down by displacement from Baseline
    Engine_Startup_Fuel_g   =    4.0*Engine_Displacement_L/3.6;   % Fuel, grams	Scaled down by displacement from Baseline

    Engine_Min_Speed_rpm    =  800;           % Max engine speed, rpm
    Engine_Max_Speed_rpm    = 6000;           % Max engine speed, rpm

    % Index maps for BSFC and Torque
    Engine_2DMAP_Index_TR   = [0.08, 0.16, 0.24, 0.32, 0.40, 0.48, 0.56, 0.64, 0.72, 0.80, 0.88, 0.96, 1.00];
    Engine_2DMAP_Index_RPM  = [800,  1200, 1600, 2000, 2400, 2800, 3200, 3600, 4000, 4800, 6000];

    Engine_Torque_2DMAP_Nm =[    14	14	14	14	14	15	15	16	16	16	15;
                                27	27	27	27	28	29	30	31	33	32	31;
                                41	41	41	41	42	44	45	47	49	48	46;
                                54	54	54	55	57	59	60	62	65	64	61;
                                68	68	68	68	71	73	76	78	82	80	77;
                                82	82	82	82	85	88	91	94	98	96	92;
                                95	95	95	96	99	102	106	109	114	111	108;
                                109	109	109	109	113	117	121	125	131	127	123;
                                122	122	122	123	127	132	136	140	147	143	138;
                                136	136	136	137	142	146	151	156	163	159	154;
                                150	150	150	150	156	161	166	172	180	175	169;
                                163	163	163	164	170	176	181	187	196	191	184;
                                170	170	170	171	177	183	189	195	204	199	192;];
    Engine_Torque_2DMAP_Nm = Engine_Torque_2DMAP_Nm';

    Engine_BSFC_2DMAP_g_kWh = [ 580.00	640.6	701.3	753.9	797.4	832.8	861.8	886.6	907.9	932.7	970.04;
                                440.29	480.6	520.9	554.4	585.0	600.1	615.4	628.9	645.5	674.5	718.07;
                                330.83	355.5	380.3	394.7	393.5	400.2	414.6	412.2	432.0	466.2	517.49;
                                263.42	279.3	295.2	301.7	302.3	307.4	303.7	300.1	317.6	354.8	410.67;
                                231.70	255.7	279.6	266.3	268.6	261.0	249.5	257.1	262.8	300.9	358.06;
                                234.26	245.6	256.9	252.4	246.4	247.8	239.9	236.8	242.1	277.7	331.13;
                                241.18	248.6	256.0	254.7	245.7	240.9	230.2	231.4	231.9	261.8	306.67;
                                230.03	225.1	243.2	244.8	241.5	236.3	231.6	230.9	230.9	267.6	322.71;
                                225.44	221.0	230.5	228.7	231.4	230.5	228.9	230.8	238.0	265.6	306.82;
                                220.00	205.4	216.3	221.1	222.6	226.5	227.5	229.9	239.0	263.7	300.74;
                                220.38	209.5	212.7	213.0	212.6	216.6	221.1	228.9	240.2	263.1	297.31;
                                248.99	234.5	220.0	222.1	229.5	221.4	231.2	235.9	241.6	265.4	301.14;
                                287.67	258.6	250.6	248.0	246.0	249.2	245.4	248.9	263.5	382.7	591.48;];
                        
    Engine_BSFC_2DMAP_g_kWh = Engine_BSFC_2DMAP_g_kWh';  

% Engine Option #3 - 2.0L 4-cyl w/ Variable Valve Timing & Calibrated
% Agressively for Fuel Economy
elseif(ICE_Option == 3)   
    Engine_Displacement_L   =    2.0;                             % Liters
    Engine_ACC_Loss_Nm      =   17.1*Engine_Displacement_L/3.6;   % Accessory loss, N-m - Scaled down by displacement from Baseline
    Engine_Startup_Fuel_g   =    4.0*Engine_Displacement_L/3.6;   % Fuel, grams	Scaled down by displacement from Baseline

    Engine_Min_Speed_rpm    =  800;           % Max engine speed, rpm
    Engine_Max_Speed_rpm    = 6000;           % Max engine speed, rpm

    % Index maps for BSFC and Torque
    Engine_2DMAP_Index_TR   = [0.08, 0.16, 0.24, 0.32, 0.40, 0.48, 0.56, 0.64, 0.72, 0.80, 0.88, 0.96, 1.00];
    Engine_2DMAP_Index_RPM  = [800,  1200, 1600, 2000, 2400, 2800, 3200, 3600, 4000, 4800, 6000];

    Engine_Torque_2DMAP_Nm =[   14	14	14	14	14	15	15	16	16	16	15;
                                27	27	27	27	28	29	30	31	33	32	31;
                                41	41	41	41	42	44	45	47	49	48	46;
                                54	54	54	55	57	59	60	62	65	64	61;
                                68	68	68	68	71	73	76	78	82	80	77;
                                82	82	82	82	85	88	91	94	98	96	92;
                                95	95	95	96	99	102	106	109	114	111	108;
                                109	109	109	109	113	117	121	125	131	127	123;
                                122	122	122	123	127	132	136	140	147	143	138;
                                136	136	136	137	142	146	151	156	163	159	154;
                                150	150	150	150	156	161	166	172	180	175	169;
                                163	163	163	164	170	176	181	187	196	191	184;
                                170	170	170	171	177	183	189	195	204	199	192;];
    Engine_Torque_2DMAP_Nm = Engine_Torque_2DMAP_Nm';

    Engine_BSFC_2DMAP_g_kWh = [ 567.40	631.83	696.26	750.70	783.46	829.20	856.83	879.73	899.17	921.63	955.32;   % 0.08
                                427.18	466.68	506.18	554.45	579.13	598.97	614.80	629.45	644.76	670.03	707.93;   % 0.16
                                311.39	341.62	371.84	394.74	393.53	400.19	414.59	412.20	432.03	458.40	497.96;   % 0.24
                                263.42	279.30	295.18	301.71	302.34	307.42	303.64	300.14	317.56	354.81	410.67;   % 0.32
                                231.70	255.66	279.62	266.25	268.63	260.97	259.09	257.08	262.79	300.90	358.06;   % 0.40
                                234.26	245.61	256.95	252.36	246.37	247.77	234.64	230.86	242.05	269.53	310.75;   % 0.48
                                245.20	248.57	251.94	254.67	245.73	240.92	230.18	231.44	231.90	261.81	306.67;   % 0.56
                                220.03	225.11	243.19	244.85	241.50	236.34	231.63	230.92	230.91	267.63	322.71;   % 0.64
                                222.61	220.95	229.29	228.67	232.55	230.48	228.91	230.76	238.04	258.31	288.72;   % 0.72
                                228.00	205.42	216.27	221.10	222.61	226.50	225.11	229.92	239.03	263.72	300.74;   % 0.80
                                220.98	209.32	212.66	213.04	212.60	216.63	221.15	228.93	240.22	264.75	301.54;   % 0.88
                                251.69	235.82	219.95	215.45	213.55	221.41	231.22	235.86	241.58	265.40	301.14;   % 0.96
                                287.67	258.64	249.62	248.03	245.97	249.16	245.41	248.92	253.47	270.88	312.00;]; % 1.00
                        
    Engine_BSFC_2DMAP_g_kWh = Engine_BSFC_2DMAP_g_kWh'; 
    

% Engine Option #4 - 2.4L 4-cyl w/ Variable Valve Timing
% - Taken/scaled from 2.0L (option 2 above)
% - Used in MEEM 5295 Individual HW2
elseif(ICE_Option == 4)
    Engine_Displacement_L   =    2.4;                             % Liters
    Engine_ACC_Loss_Nm      =   17.1*Engine_Displacement_L/3.6;   % Accessory loss, N-m - Scaled down by displacement from Baseline
    Engine_Startup_Fuel_g   =    4.0*Engine_Displacement_L/3.6;   % Fuel, grams	Scaled down by displacement from Baseline

    Engine_Min_Speed_rpm    =  800;           % Max engine speed, rpm
    Engine_Max_Speed_rpm    = 6000;           % Max engine speed, rpm

    % Index maps for BSFC and Torque
    Engine_2DMAP_Index_TR   = [0.08, 0.16, 0.24, 0.32, 0.40, 0.48, 0.56, 0.64, 0.72, 0.80, 0.88, 0.96, 1.00];
    Engine_2DMAP_Index_RPM  = [800,  1200, 1600, 2000, 2400, 2800, 3200, 3600, 4000, 4800, 6000];

    Engine_Torque_2DMAP_Nm =[    14	14	14	14	14	15	15	16	16	16	15;
                                27	27	27	27	28	29	30	31	33	32	31;
                                41	41	41	41	42	44	45	47	49	48	46;
                                54	54	54	55	57	59	60	62	65	64	61;
                                68	68	68	68	71	73	76	78	82	80	77;
                                82	82	82	82	85	88	91	94	98	96	92;
                                95	95	95	96	99	102	106	109	114	111	108;
                                109	109	109	109	113	117	121	125	131	127	123;
                                122	122	122	123	127	132	136	140	147	143	138;
                                136	136	136	137	142	146	151	156	163	159	154;
                                150	150	150	150	156	161	166	172	180	175	169;
                                163	163	163	164	170	176	181	187	196	191	184;
                                170	170	170	171	177	183	189	195	204	199	192;];
    % Scale by displacement (e.g., BMEP)
    Engine_Torque_2DMAP_Nm = Engine_Displacement_L/2.0*Engine_Torque_2DMAP_Nm';
    % Scale to 160 ft-lb at 4500 RPM;
    Engine_Torque_2DMAP_Nm = 0.9*Engine_Torque_2DMAP_Nm;
    
    Engine_BSFC_2DMAP_g_kWh = [ 580.00	640.6	701.3	753.9	797.4	832.8	861.8	886.6	907.9	932.7	970.04;
                                440.29	480.6	520.9	554.4	585.0	600.1	615.4	628.9	645.5	674.5	718.07;
                                330.83	355.5	380.3	394.7	393.5	400.2	414.6	412.2	432.0	466.2	517.49;
                                263.42	279.3	295.2	301.7	302.3	307.4	303.7	300.1	317.6	354.8	410.67;
                                231.70	255.7	279.6	266.3	268.6	261.0	249.5	257.1	262.8	300.9	358.06;
                                234.26	245.6	256.9	252.4	246.4	247.8	239.9	236.8	242.1	277.7	331.13;
                                241.18	248.6	256.0	254.7	245.7	240.9	230.2	231.4	231.9	261.8	306.67;
                                230.03	225.1	243.2	244.8	241.5	236.3	231.6	230.9	230.9	267.6	322.71;
                                225.44	221.0	230.5	228.7	231.4	230.5	228.9	230.8	238.0	265.6	306.82;
                                220.00	205.4	216.3	221.1	222.6	226.5	227.5	229.9	239.0	263.7	300.74;
                                220.38	209.5	212.7	213.0	212.6	216.6	221.1	228.9	240.2	263.1	297.31;
                                248.99	234.5	220.0	222.1	229.5	221.4	231.2	235.9	241.6	265.4	301.14;
                                287.67	258.6	250.6	248.0	246.0	249.2	245.4	248.9	263.5	382.7	591.48;];
                        
    Engine_BSFC_2DMAP_g_kWh = Engine_BSFC_2DMAP_g_kWh';     
    
    
    
% Engine Option #4 - 2.4L 4-cyl w/ Variable Valve Timing
% - Expanded low BSFC Zone
% - Matched to engine characteristics
%   - Power  = 169hp (126 kW) @ 6400 RPM
%   - Torque = 160ft-lbf (229 Nm) @ 4500 RPM
%
elseif(ICE_Option == 5)
    Engine_Displacement_L   =    2.4;                                   % Liters
    Engine_ACC_Loss_Nm      =    4.6;                                   % Accessory loss, N-m - Scaled down by displacement from Baseline
    Engine_Startup_Fuel_g   =     4.0*Engine_Displacement_L/3.6;        % Fuel, grams	Scaled down by displacement from Baseline

    Engine_Min_Speed_rpm    =  600;           % Max engine speed, rpm
    Engine_Max_Speed_rpm    = 6800;           % Max engine speed, rpm

    % Index maps for BSFC and Torque
    Engine_2DMAP_Index_TR   = [0.08, 0.16, 0.24, 0.32, 0.40, 0.48, 0.56, 0.64, 0.72, 0.80, 0.88, 0.96, 1.00];
    Engine_2DMAP_Index_RPM  = [600,  1200, 1600, 2000, 2400, 2800, 3200, 3600, 4000, 4800, 6000, 6400, 6800];

    Engine_Torque_2DMAP_Nm =[    16.0	 16.0	 16.0	 16.0	 16.0	 17.1	 17.1	 18.2	 18.2	 18.2	 15.4	  5.2	  4.1;
								 30.8	 30.8	 30.8	 30.8	 31.9	 33.1	 34.2	 35.3	 37.6	 36.5	 31.8	 21.9	 17.5;
								 46.7	 46.7	 46.7	 46.7	 47.9	 50.2	 51.3	 53.6	 55.9	 54.7	 47.2	 37.6	 30.0;
								 61.6	 61.6	 61.6	 62.7	 65.0	 67.3	 68.4	 70.7	 74.1	 73.0	 62.7	 53.2	 42.4;
								 77.5	 77.5	 77.5	 77.5	 80.9	 83.2	 86.6	 88.9	 93.5	 91.2	 79.2	 70.0	 55.9;
								 93.5	 93.5	 93.5	 93.5	 96.9	100.3	103.7	107.2	111.7	109.4	 94.5	 85.7	 68.4;
								108.3	108.3	108.3	109.4	112.9	116.3	120.8	124.3	130.0	126.5	111.0	102.4	 81.7;
								124.3	124.3	124.3	124.3	128.8	133.4	137.9	142.5	149.3	144.8	126.5	118.0	 94.1;
								139.1	139.1	139.1	140.2	144.8	150.5	155.0	159.6	167.6	163.0	141.9	133.7	106.7;
								155.0	155.0	155.0	156.2	161.9	166.4	172.1	177.8	185.8	181.3	158.4	150.5	120.1;
								171.0	171.0	171.0	171.0	177.8	183.5	189.2	196.1	205.2	199.5	173.8	166.1	132.5;
								185.8	185.8	185.8	187.0	193.8	200.6	206.3	213.2	223.4	217.7	189.2	181.8	145.1;
								193.8	193.8	193.8	194.9	201.8	208.6	215.5	222.3	232.6	226.9	197.4	188.0	150.0; ];
    Engine_Torque_2DMAP_Nm = Engine_Torque_2DMAP_Nm';
    
    %                            [600,  1200,   1600,   2000,   2400,   2800,   3200,   3600,   4000,   5000,   6000,   6600];
    Engine_BSFC_2DMAP_g_kWh = [ 820.00	760.6	731.3	753.9	797.4	832.8	861.8	886.6	907.9	932.7	970.04  999.04  999.04;   % 0.08
                                740.29	690.6	550.9	554.4	585.0	600.1	615.4	628.9	650.5	700.5	750.07	820.07  820.07;   % 0.16
                                650.83	550.5	410.3	398.7	399.5	400.2	408.6	412.2	432.0	566.2	617.49	657.49  657.49;   % 0.24
                                543.42	410.3	315.2	301.7	302.3	280.4	303.7	300.1	317.6	354.8	450.67	550.67  550.67;
                                411.70	355.7	260.6	243.3	258.6	251.0	249.5	257.1	262.8	320.9	388.06	428.06  428.06;
                                369.26	275.6	230.9	220.4	218.4	229.8	235.9	244.8	252.1	303.7	361.13	411.13  411.13;
                                349.18	268.6	220.0	210.7	210.7	215.9	222.2	233.4	241.9	297.8	356.67	408.67  408.67;   % 0.48
                                356.03	238.1	212.2	206.8	208.5	213.3	221.6	230.9	240.9	297.6	332.71	402.71  402.71;
                                345.44	225.0	204.5	200.7	204.4	210.5	218.9	230.8	248.0	295.6	336.82	406.82  406.82;
                                340.00	215.4	203.3	195.1	199.6	205.5	218.5	229.9	249.0	293.7	345.74	405.74  405.74;   % 0.80
                                350.38	229.5	205.7	201.0	203.6	210.6	220.1	228.9	250.2	318.1	355.31	407.31  407.31;
                                368.99	244.5	228.0	216.1	219.5	223.4	231.2	245.9	281.6	320.4	441.14	481.14  481.14; 
                                407.67	268.6	250.6	245.0	246.0	248.2	252.4	269.9	303.5	400.7	591.48	600.48  600.48;];
                        
    Engine_BSFC_2DMAP_g_kWh = Engine_BSFC_2DMAP_g_kWh';     
    
    % Use this to printout above
    % sprintf('\t\t\t\t\t\t\t\t%5.1f\t%5.1f\t%5.1f\t%5.1f\t%5.1f\t%5.1f\t%5.1f\t%5.1f\t%5.1f\t%5.1f\t%5.1f\t%5.1f\t%5.1f;\n',  Engine_Torque_2DMAP_Nm);    
    
end

